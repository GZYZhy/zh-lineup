# 文件排序器 (zh-lineup)
一个简单的工具，让你的文件和目录按照意愿排列。

## 使用方法

运行Python脚本 `lineup.py` 来启动图形界面。

```bash
python lineup.py
```

界面分为三个选项卡：主界面、配置、关于。

### 主界面
- **📁 选择源文件夹**：浏览并选择包含文件/目录的源文件夹。
- **📋 目的列表输入**：
  - **导入文件**：选择文本文件，每行一个文件名/目录名模式。
  - **导入Excel**：选择Excel文件，读取第一张工作表的第一列作为列表项。
  - **手动输入**：在文本框中直接输入列表项，每行一项。
- **⚡ 快速设置**：调整相似度阈值，选择自动选择最高相似度或仅生成列表。
- **🔍 预览**：预览操作结果，不实际执行复制。
- **▶️ 运行**：执行排序，创建 `Result/` 目录并生成结果。

### 配置
- **📤 输出设置**：选择输出格式（文本/JSON/M3U）和文件名格式。
- **🏷️ 重命名设置**：配置重命名模式和参数。
- **🔧 其他选项**：如忽略目录等高级选项。

### 关于
程序信息和使用教程。

程序使用相似度匹配文件夹中的项目：
- 移除模式中的括号。
- 计算模式与项目名的相似度（使用difflib）。
- 如果相似度为1.0，完全匹配，优先使用。
- 如果相似度高于阈值，则为候选。
- 如果有多个候选，根据设置选择或弹出对话框。

匹配的项目将被复制到 `Result/` 子目录，重命名（添加前缀1-、2-等），并生成 `Result.list` 文件列出结果、未匹配的项目和未使用的项目。

## 示例

给定列表：
```
abc_123(aaa).mp3
cde_123
aaa123.txt
12456.abc
```

文件夹 `Folder/` 中有文件：
- aaa123_.txt
- abc_123.mp3
- cde_123.ppt
- haha.aaa

运行后创建 `Folder/Result/` 包含：
- 1-abc_123.mp3
- 2-cde_123.ppt
- 3-aaa123_.txt
- Result.list

`Result.list` 内容：
```
# 文件排序 for 文件夹 Folder
# 使用配置 相似度阈值 0.6
1-abc_123.mp3 (文件)
2-cde_123.ppt (文件)
3-aaa123_.txt (文件)
# 未匹配项目 (总共 1 个未匹配)
# 12456.abc(第 4 行)
# 文件夹中未使用的项目 (总共 1 个项目)
# haha.aaa (文件)
```

## GitHub
https://github.com/GZYZhy/zh-lineup

`Result.list` 内容：
```
# 文件排序 for 文件夹 Folder
# 使用配置 相似度阈值 0.6
1-abc_123.mp3
2-cde_123.ppt
3-aaa123_.txt
# 未匹配项目 (总共 1 个未匹配)
# 12456.abc(第 4 行)
# 文件夹中未使用的文件 (总共 1 个文件)
# haha.aaa
```
